Menu="Apcupsd:2"
Title="UPS Status"
---
<?PHP
/* Copyright 2014, Dan Landon.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License version 2,
 * as published by the Free Software Foundation.
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */
?>

<div style='font-family: courier new;'>
	<?
	$apcupsd_running = file_exists( "/var/run/$sName.pid") ? "yes" : "no";

	if ($apcupsd_running=="yes") {
		$apcaccessoutput=`/sbin/apcaccess`;

		$lines = split("\n", $apcaccessoutput);

		foreach ($lines as $line) {
			$pos = strpos($line, ":");

			if ($pos !== false){
				$right = substr($line, 0, $pos+1);
				$right = str_replace(' ', '&nbsp;', $right);
				$left = substr($line, $pos+2);
				$space = str_repeat('&nbsp;', 10);

				echo("$space<strong>$right</strong>&nbsp;$left<br />");
			} else {
				echo("$line<br />");
			}
		}
	} else {
		echo("<span class='status_head'>UPS: </span>");
		echo("<span class='red'>Offline</span>");
	}
	?>
</div>
